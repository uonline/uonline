mixin instanceLink(name, url, text, icon, forceNotActive)
	- var activity = (instance === name);
	- if (forceNotActive) activity = false;
	li.instance-link(class = (activity ? 'active' : null))
		if icon != null
			a.pjax(href=url) <i class="#{icon}"></i> #{text}
		else
			a.pjax(href=url) #{text}

if !pjax
	doctype html
	html
		head
			meta(charset='utf-8')
			title
				block title
			link(href='/static/bootstrap/css/bootstrap.min.css', rel='stylesheet', media='screen')
			style.
				body { padding-top: 60px; }
			link(href='/static/bootstrap/css/bootstrap-responsive.min.css', rel='stylesheet', media='screen')
			// if lt IE 9
				script(src='http://html5shim.googlecode.com/svn/trunk/html5.js')
			script(src='/static/bower_components/jquery/dist/jquery.min.js')
			script(src='/static/bootstrap/js/bootstrap.min.js')
			script(src='/static/bower_components/jquery-pjax/jquery.pjax.js')
			:coffee
				$(document).pjax('a.pjax', '#content')
		body
			div.navbar.navbar-fixed-top
				div.navbar-inner
					div.container
						a.brand(href='/') uonline
						ul.nav
							+instanceLink('about','/about/','Об игре')
						ul.nav.pull-right
							if loggedIn === true
								li
									a(href='/profile/')
										i(class=(admin?'icon-certificate':'icon-user'))
										| #{' '}#{login}
								+instanceLink('profile', '/profile/', 'Профиль', null, !profileIsMine)
								+instanceLink('game', '/game/', 'Игра')
								li
									a(href='/action/logout') Выйти
							else
								+instanceLink('login', '/login/', 'Вход', 'icon-chevron-right')
								+instanceLink('register', '/register/', 'Регистрация')

			div.container
				div#content
					block content
				hr
				footer
					p.muted &copy; m1kc и К<sup>о</sup>, 2012&ndash;#{ now.getFullYear() }
			:coffee
				# Push buttons
				$('.instance-link').click ->
					$('.instance-link').removeClass 'active'
					$(this).addClass 'active'
else
	title
		block title
	block content
